/* âœ… ALL @import statements MUST come first */
@import "react-quill/dist/quill.snow.css";
@import url("https://fonts.googleapis.com/css2?family=Arial:wght@400;700&family=Calibri:wght@400;700&family=Cambria:wght@400;700&family=Times+New+Roman:wght@400;700&family=Georgia:wght@400;700&family=Garamond:wght@400;700&family=Verdana:wght@400;700&family=Courier+New:wght@400;700&display=swap");
@import "./styles/quill-fonts.css";

/* Tailwind */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================
   Quill font mapping
   ============================ */
.ql-font-arial {
  font-family: "Arial", sans-serif;
}
.ql-font-calibri {
  font-family: "Calibri", sans-serif;
}
.ql-font-cambria {
  font-family: "Cambria", serif;
}
.ql-font-timesnewroman {
  font-family: "Times New Roman", serif;
}
.ql-font-georgia {
  font-family: "Georgia", serif;
}
.ql-font-garamond {
  font-family: "Garamond", serif;
}
.ql-font-verdana {
  font-family: "Verdana", sans-serif;
}
.ql-font-couriernew {
  font-family: "Courier New", monospace;
}
.ql-font-sans {
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial,
    sans-serif;
}
.ql-font-serif {
  font-family: ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
}
.ql-font-mono {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
    "Liberation Mono", monospace;
}

/* Quill picker label text (optional, nice UX) */
.ql-snow .ql-picker.ql-font .ql-picker-label[data-value="sans"]::before,
.ql-snow .ql-picker.ql-font .ql-picker-item[data-value="sans"]::before {
  content: "Sans Serif";
}
.ql-snow .ql-picker.ql-font .ql-picker-label[data-value="serif"]::before,
.ql-snow .ql-picker.ql-font .ql-picker-item[data-value="serif"]::before {
  content: "Serif";
}
.ql-snow .ql-picker.ql-font .ql-picker-label[data-value="mono"]::before,
.ql-snow .ql-picker.ql-font .ql-picker-item[data-value="mono"]::before {
  content: "Mono";
}
.ql-snow .ql-picker.ql-font .ql-picker-label[data-value="georgia"]::before,
.ql-snow .ql-picker.ql-font .ql-picker-item[data-value="georgia"]::before {
  content: "Georgia";
}
.ql-snow .ql-picker.ql-font .ql-picker-label[data-value="garamond"]::before,
.ql-snow .ql-picker.ql-font .ql-picker-item[data-value="garamond"]::before {
  content: "Garamond";
}
.ql-snow .ql-picker.ql-font .ql-picker-label[data-value="times"]::before,
.ql-snow .ql-picker.ql-font .ql-picker-item[data-value="times"]::before {
  content: "Times";
}

/* ============================
   Quill toolbar normalization
   ============================ */
.ql-toolbar,
.ql-toolbar * {
  font-size: 14px !important;
}

.ql-toolbar .ql-picker-label::before {
  line-height: 1.2 !important;
}

/* Ensure Quill toolbar buttons match app styling */
.ql-toolbar button {
  transition: background-color 0.15s ease;
}

.ql-toolbar button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

/* ===========================================================
   âœ… FIX: Stop Quill UI from overlapping the LEFT SIDEBAR
   -----------------------------------------------------------
   The old rule used z-index: 30 globally which can cause the
   editor UI to sit "above" neighboring grid columns.
   =========================================================== */
.ql-toolbar {
  overflow: visible !important;
  position: relative; /* z-index only works reliably with positioned elements */
  z-index: 2; /* keep above editor content, not above other layout columns */
}

.ql-container {
  position: relative;
  z-index: 1;
}

/* Dropdown options panel should show above toolbar but stay local */
.ql-snow .ql-picker.ql-expanded .ql-picker-options {
  z-index: 6;
}

/* Quill tooltip (link tooltip etc.) */
.ql-tooltip {
  z-index: 7;
}

/* === NEW: Line-height picker (1 / 1.5 / 2) visibility & styling === */
.ql-toolbar .ql-picker.ql-line-height .ql-picker-label::before,
.ql-toolbar .ql-picker.ql-line-height .ql-picker-item::before {
  color: #0f172a;
  font-size: 12px;
}

/* Dropdown panel background for the line-height picker */
.ql-toolbar .ql-picker.ql-line-height .ql-picker-options {
  background: #ffffff;
  border: 1px solid #e5e7eb;
  box-shadow: 0 8px 16px rgba(15, 23, 42, 0.12);
  z-index: 8;
}

/* Give the line-height picker a bit of width so numbers do not get clipped */
.ql-toolbar .ql-picker.ql-line-height {
  min-width: 2.5rem;
}

/* Keep a little space between paragraphs inside the editor */
.ql-editor p {
  margin: 0 0 0.75em 0;
}

/* ðŸ”¹ Editor line spacing helpers */
.storylab-editor .ql-editor {
  line-height: 1.5;
}

.storylab-lh-1 .ql-editor {
  line-height: 1;
}

.storylab-lh-1_5 .ql-editor {
  line-height: 1.5;
}

.storylab-lh-2 .ql-editor {
  line-height: 2;
}

/* ================================
   Brand + Global Base (LIGHT THEME)
   ================================ */
@layer base {
  :root,
  .theme-light {
    /* App color tokens */
    --color-base: #f7fafc;
    --color-primary: #eaf2ff;
    --color-accent: #cab1d6;
    --color-gold: #d4af37;
    --color-ink: #0f172a;
    --color-muted: #94a3b8;

    /* Brand tokens used by components & gradients */
    --brand-navy: #0b1b3b;
    --brand-rose: #cab1d6;
    --brand-gold: #d4af37;
    --brand-mauve: #8b6f8f;
    --brand-ink: #0f172a;

    /* HSL tokens (optional: shadcn/ui-style usage) */
    --background: 210 50% 98%;
    --foreground: 222 47% 11%;
    --muted: 215 20% 93%;
    --muted-foreground: 215 16% 35%;
    --card: 0 0% 100%;
    --card-foreground: 222 47% 11%;
    --popover: 0 0% 100%;
    --popover-foreground: 222 47% 11%;
    --primary: 215 100% 92%;
    --primary-foreground: 222 47% 11%;
    --secondary: 276 26% 80%;
    --secondary-foreground: 222 47% 11%;
    --accent: 276 26% 80%;
    --accent-foreground: 222 47% 11%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;
    --border: 215 20% 91%;
    --input: 215 20% 91%;
    --ring: 47 65% 54%;
    --radius: 0.75rem;
  }

  html,
  body,
  #root {
    height: 100%;
  }

  body {
    margin: 0;
    font-family: "Inter", ui-sans-serif, system-ui, -apple-system, "Segoe UI",
      Roboto, Arial, "Helvetica Neue", sans-serif;
    font-size: 16px;
    line-height: 1.6;
    color: var(--color-ink);
    background-color: var(--color-base);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  .heading-serif {
    font-family: "Playfair Display", ui-serif, Georgia, Cambria, "Times New Roman",
      Times, serif;
    font-weight: 700;
    line-height: 1.25;
    color: var(--color-ink);
  }

  code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
      "Liberation Mono", "Courier New", monospace;
  }

  img {
    image-rendering: -webkit-optimize-contrast;
  }
}

/* ===================================
   Optional: Dark theme (toggle .theme-dark)
   =================================== */
.theme-dark {
  --background: 222 61% 7%;
  --foreground: 210 40% 98%;
  --muted: 215 20% 17%;
  --muted-foreground: 215 20% 65%;
  --card: 222 61% 9%;
  --card-foreground: 210 40% 98%;
  --popover: 222 61% 9%;
  --popover-foreground: 210 40% 98%;
  --primary: 199 89% 48%;
  --primary-foreground: 210 40% 98%;
  --secondary: 215 20% 17%;
  --secondary-foreground: 210 40% 98%;
  --accent: 199 89% 48%;
  --accent-foreground: 210 40% 98%;
  --destructive: 0 84% 60%;
  --destructive-foreground: 210 40% 98%;
  --border: 215 20% 20%;
  --input: 215 20% 20%;
  --ring: 199 89% 48%;
  color: hsl(var(--foreground));
  background-color: hsl(var(--background));
}

/* =======================
   Reusable Helper Classes
   ======================= */
@layer components {
  .glass-panel {
    @apply bg-white/60 backdrop-blur-xl border border-white/40 rounded-2xl shadow-lg;
  }
  .glass-soft {
    @apply bg-white/40 backdrop-blur-md border border-white/30 rounded-xl shadow;
  }

  .btn-primary {
    @apply font-medium px-4 py-2 rounded-lg;
    background: var(--color-accent);
    color: var(--color-ink);
  }
  .btn-gold {
    @apply font-medium px-4 py-2 rounded-lg;
    background: var(--color-gold);
    color: white;
  }

  .text-muted {
    color: var(--color-muted);
  }
}

/* Optional radial background accent for hero/dashboard */
.bg-radial-fade {
  background-image: radial-gradient(
    circle at 20% 10%,
    rgba(202, 177, 214, 0.25),
    rgba(234, 242, 255, 0) 60%
  );
}

/* Optional DnD visuals (CSS-only) */
.dnd-draggable {
  touch-action: none;
}
.dnd-dragging {
  opacity: 0.5;
}
.dnd-drop-hover {
  border-color: #4f46e5 !important;
  background-color: rgba(79, 70, 229, 0.1) !important;
}

/* ---------- Brand tokens (safe defaults) ---------- */
:root {
  /* Core surfaces */
  --brand-bg: #faf7fb;
  --brand-white: #ffffff;
  --brand-surface: #ffffff;

  /* Borders */
  --brand-border: #ead9e5;
  --brand-border-strong: #e3cfe0;

  /* Text */
  --brand-text: #2b2330;
  --brand-subtext: #6b5a68;

  /* Primary brand */
  --brand-primary: #ec4899;
  --brand-accent: #f472b6;
  --brand-highlight: rgba(236, 72, 153, 0.1);

  /* Header gradient */
  --brand-rose: #ec4899;
  --brand-pink: #f9a8d4;
}

/* Optional: subtle page smoothing & resets */
html,
body,
#root {
  min-height: 100%;
  background: var(--brand-bg);
  color: var(--brand-text);
}

button {
  font: inherit;
}

select,
input,
textarea {
  font: inherit;
  color: var(--brand-text);
}

iframe {
  background: transparent;
}

/* Make sticky sidebars feel right on iOS/Safari */
@supports (position: sticky) {
  aside[aria-label="Publishing sidebar"] {
    will-change: transform;
  }
}

/* Optional: nicer focus ring for accessibility */
:focus-visible {
  outline: 2px solid var(--brand-accent);
  outline-offset: 2px;
}

/* --- Publishing header + brand tune --- */
:root {
  /* Softer blush tones for header + accents */
  --brand-rose: #e48aa8;
  --brand-peach: #f6c0b3;

  /* Align primary/accent with softer scheme */
  --brand-primary: #d46d92;
  --brand-accent: #f1a3bf;
  --brand-highlight: rgba(212, 109, 146, 0.12);
}

/* Keep alias if you were using brand-pink */
:root {
  --brand-peach: var(--brand-pink);
}
